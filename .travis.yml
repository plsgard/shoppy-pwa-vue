language: node_js
node_js: stable
sudo: required

# échoue dès qu'une erreur intervient
matrix:
  fast_finish: true

# met en cache node_modules, à noter que dans ce genre d’utilisation pour des
# bibliothèques open source consommées via npm, il ne faudra pas oublier
# npm prune utilisé ci-après, histoire de ne pas lancer des tests avec
# des paquets encore en cache mais non présents dans le package.json
cache:
  directories:
    - node_modules

before_install:
  - npm prune

install:
  - npm install

script:
  # - npm run test
  - npm run build

before_deploy:
  - cd dist
deploy:
  provider: azure_web_apps
  skip_cleanup: true
  verbose: true
